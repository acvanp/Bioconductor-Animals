linetype = FALSE)
p
flip(p, 18)
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18))
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(0, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
flip(p, 18)
tree <- groupClade(musselTree)
ggtree(tree, aes(color=group, linetype=group))
tree <- groupClade(musselTree, .node = c(12,13,14)+1)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(0, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree, .node = c(12,13,14,18))
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(0, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree, .node = c(12,13,14, 18)+1)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(0, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
flip(p, 18)
flip(p, 18)
p
rotate(p, 18)
rotate(p, 14)
rotate(p, 18)
rotate(p, 17, 18)
rotate(p, 18)
rotate(p, 17)
p
rotate(p, 19)
tree$edge.length
tree$edge.length[17]
plot(tree)
tree$edge.length[17] =-10
plot(tree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[17] =-0.1
plot(tree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:10] = -tree$edge.length[1:10]
plot(tree)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:9] = -tree$edge.length[1:9]
tree <- groupClade(musselTree, .node = c(12,13,14,18))
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:8] = -tree$edge.length[1:8]
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:9] = -tree$edge.length[1:9]
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:10] = -tree$edge.length[1:10]
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 18)
9
rotate(p, 19)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:11] = -tree$edge.length[1:11]
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 19)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[1:10] = -tree$edge.length[1:10]
tree <- groupClade(musselTree, .node = c(12,13,14,18))
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Mollusks"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 19)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk COI Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 19)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 19)
tree$edge.length[1:10]
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[2:10] = -tree$edge.length[2:10]
tree <- groupClade(musselTree, .node = c(12,13,14,18))
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-1.50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-50, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-0.5, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4))) +
ggplot2::xlim(-0.8, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4),hjust = -1 )) +
ggplot2::xlim(-0.8, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4), hjust = -10 )) +
ggplot2::xlim(-0.8, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = -10 ) +
ggplot2::xlim(-0.8, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = -1 ) +
ggplot2::xlim(-0.8, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = 1 ) +
ggplot2::xlim(-0.8, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Phylogenetic Tree Based on Mollusk ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = 1 ) +
ggplot2::xlim(-1.3, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Unionid and Invertebrate Phylogenetic Tree with ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = 1 ) +
ggplot2::xlim(-1.3, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 19)
setwd("C:\\Users\\Lenovo\\BioconductorAnimals")
write(ll, "mussels_COI.fasta", sep="\n")
setwd("C:\\Users\\Lenovo\\BioconductorAnimals")
write(ll, "mussels_ND1.fasta", sep="\n")
species_list = c("Amblema plicata", "Cyrtonaias tampicoensis",
"Lampsilis cardium", "Margaritifera margaritifera",
"Ellipsaria lineolata", "Elliptio complanata",
"Megalonaias nervosa", "Crassostrea virginica",
"Arctica islandica", # "Caenorhabditis elegans" , # nematode worm outgroup
"Conus ermineus", "Tridacna gigas")
ll = c()
for(i in 1:length(species_list)){
t = paste(species_list[i], "[Organism] AND ND1[Gene]", sep = "")
#t = paste(species_list[i], "[Organism] AND COI[Gene]", sep = "")
m = entrez_search(db = "nuccore", term = t, retmax = 1)
m = entrez_fetch(db="nuccore", id=m$ids, rettype="fasta")
ll = append(ll, m)
}
setwd("C:\\Users\\Lenovo\\BioconductorAnimals")
write(ll, "mussels_ND1.fasta", sep="\n")
for(i in 1:length(species_list)){
#t = paste(species_list[i], "[Organism] AND ND1[Gene]", sep = "")
t = paste(species_list[i], "[Organism] AND COI[Gene]", sep = "")
m = entrez_search(db = "nuccore", term = t, retmax = 1)
m = entrez_fetch(db="nuccore", id=m$ids, rettype="fasta")
ll = append(ll, m)
}
ll = c()
for(i in 1:length(species_list)){
#t = paste(species_list[i], "[Organism] AND ND1[Gene]", sep = "")
t = paste(species_list[i], "[Organism] AND COI[Gene]", sep = "")
m = entrez_search(db = "nuccore", term = t, retmax = 1)
m = entrez_fetch(db="nuccore", id=m$ids, rettype="fasta")
ll = append(ll, m)
}
setwd("C:\\Users\\Lenovo\\BioconductorAnimals")
#write(ll, "mussels_ND1.fasta", sep="\n")
write(ll, "mussels_COI.fasta", sep="\n")
mussels_COI_seqinr_format <- read.fasta("mussels_COI.fasta")
musselSeq <- readAAStringSet("mussels_COI.fasta")
musselAln <- msa(musselSeq)
## use default substitution matrix
musselAln
musselAln2 <- msaConvert(musselAln, type="seqinr::alignment")
d <- dist.alignment(musselAln2, "identity")
musselTree <- nj(d)
df = data.frame(color=sample(c('red', 'blue', 'green'),
length(musselTree$tip.label), replace=T))
rownames(df) = musselTree$tip.label
#musselTree = phylo4d(as(musselTree, 'phylo4'), df)
for(i in 1:length(musselTree$tip.label)){
musselTree$tip.label[i] = paste(strsplit(musselTree$tip.label, " ")[[i]][2:3], collapse = " ")
}
plot(musselTree, main="Phylogenetic Tree Based on Mollusk COI Sequences", cex = 0.8)
plot.phylo(musselTree, type="unrooted", cex = 0.5)
#musselTree = groupOTU(musselTree, musselTree$tip.label)
# https://guangchuangyu.github.io/ggtree-book/chapter-ggtree.html
#ggtree(musselTree,  layout='circular') + geom_tiplab(size=3, aes(angle=angle)) + theme(legend.position="none")+ aes(color=I(color))
ggtree(musselTree,  layout='slanted',  branch.length="none") + geom_tiplab(size=3, aes(angle=90)) + theme(legend.position="none") +
coord_flip() + ggplot2::xlim(0, 10)
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[2:10] = -tree$edge.length[2:10]
tree <- groupClade(musselTree, .node = c(12,13,14,18))
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Unionid and Invertebrate Phylogenetic Tree with ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = 1 ) +
ggplot2::xlim(-1.3, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
rotate(p, 19)
tree <- groupClade(musselTree)
tree <- groupClade(musselTree)
species_list = c("Amblema plicata", "Cyrtonaias tampicoensis",
"Lampsilis cardium", "Margaritifera margaritifera",
"Ellipsaria lineolata", "Elliptio complanata",
"Megalonaias nervosa", "Crassostrea virginica",
"Arctica islandica", # "Caenorhabditis elegans" , # nematode worm outgroup
"Conus ermineus", "Tridacna gigas")
ll = c()
for(i in 1:length(species_list)){
#t = paste(species_list[i], "[Organism] AND ND1[Gene]", sep = "")
t = paste(species_list[i], "[Organism] AND COI[Gene]", sep = "")
m = entrez_search(db = "nuccore", term = t, retmax = 1)
m = entrez_fetch(db="nuccore", id=m$ids, rettype="fasta")
ll = append(ll, m)
}
setwd("C:\\Users\\Lenovo\\BioconductorAnimals")
#write(ll, "mussels_ND1.fasta", sep="\n")
write(ll, "mussels_COI.fasta", sep="\n")
mussels_COI_seqinr_format <- read.fasta("mussels_COI.fasta")
musselSeq <- readAAStringSet("mussels_COI.fasta")
musselAln <- msa(musselSeq)
musselAln
musselAln2 <- msaConvert(musselAln, type="seqinr::alignment")
d <- dist.alignment(musselAln2, "identity")
musselTree <- nj(d)
df = data.frame(color=sample(c('red', 'blue', 'green'),
length(musselTree$tip.label), replace=T))
rownames(df) = musselTree$tip.label
for(i in 1:length(musselTree$tip.label)){
musselTree$tip.label[i] = paste(strsplit(musselTree$tip.label, " ")[[i]][2:3], collapse = " ")
}
plot(musselTree, main="Phylogenetic Tree Based on Mollusk COI Sequences", cex = 0.8)
plot.phylo(musselTree, type="unrooted", cex = 0.5)
# https://guangchuangyu.github.io/ggtree-book/chapter-ggtree.html
#ggtree(musselTree,  layout='circular') + geom_tiplab(size=3, aes(angle=angle)) + theme(legend.position="none")+ aes(color=I(color))
ggtree(musselTree,  layout='slanted',  branch.length="none") + geom_tiplab(size=3, aes(angle=90)) + theme(legend.position="none") +
coord_flip() + ggplot2::xlim(0, 10)
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
tree$edge.length[2:10] = -tree$edge.length[2:10]
c(12,13,14,18)+1
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
p = ggtree(tree, aes(color=group, linetype=group)) +
ggtitle("Unionid and Invertebrate Phylogenetic Tree with ND1 Sequences") +
#geom_text(aes(label = node)) + # run this line to identify nodes to rotate
geom_tiplab(aes(subset=(group==1))) +
geom_tiplab(aes(subset=(group==2))) +
geom_tiplab(aes(subset=(group==3))) +
geom_tiplab(aes(subset=(group==4)), hjust = 1 ) +
ggplot2::xlim(-1.3, 1.5) +
scale_color_manual(labels = c("Uniodae1", "Unioda", "Uniodae2", "Other Invertebrates"),
values = c("black", "purple", "navy", "magenta") ) +
guides(color = guide_legend(override.aes = list(linetype = c('solid','solid', 'solid', 'solid'))),
linetype = FALSE)
p
tree <- groupClade(musselTree)
tree <- groupClade(musselTree, .node = c(12,13,14,18)+1)
